# Προχωρημένα Θέματα Βάσεων Δεδομένων

**Ονοματεπώνυμο:** Κωνσταντίνος Διβριώτης

**ΑΜ:** 03114140

**Group:** 15

## Εξαμηνιαία Εργασία 2024-2025

### Περιγραφή

Στην παρούσα εξαμηνιαία εργασία ζητείται ανάλυση σε (μεγάλα) σύνολα δεδομένων, εφαρμόζοντας επεξεργασία με τεχνικές που εφαρμόζονται σε data science projects. 

Τα εργαλεία που θα χρησιμοποιηθούν στα πλαίσια του project είναι τα **Apache Hadoop** (version>=3.0) και **Apache Spark** (version>=3.5).

Καλείστε να χρησιμοποιήσετε τους πόρους στο ειδικά διαμορφωμένο περιβάλλον που σας έχει παραχωρηθεί στο AWS cloud. 

Συνοπτικά, ο σκοπός της εργασίας είναι:
- Η εξοικείωση και ανάπτυξη των δεξιοτήτων των σπουδαστών στην εγκατάσταση και διαχείριση των κατανεμημένων συστημάτων Apache Spark και Apache Hadoop.
- Η χρήση σύγχρονων τεχνικών μέσω των API του Spark για την ανάλυση δεδομένων όγκου.
- H κατανόηση των δυνατοτήτων και περιορισμών των εργαλείων αυτών σε σχέση με τους διαθέσιμους πόρους και τις ρυθμίσεις που έχουν επιλεγεί.

### Δεδομένα

Στην παράγραφο αυτή θα παρουσιαστούν τα δεδομένα που θα κληθείτε να χρησιμοποιήσετε στα πλαίσια της εξαμηνιαίας εργασίας. Πρόκειται για δημοσίως διαθέσιμα και δωρεάν σύνολα δεδομένων που έχουν περισυλλεγεί από διαφορετικές πηγές.

#### Βασικό data-set: Los Angeles Crime Data

Το βασικό σύνολο δεδομένων που θα χρησιμοποιηθεί στην εργασία προέρχεται από το δημόσιο αποθετήριο δεδομένων της κυβέρνησης των Ηνωμένων Πολιτειών της Αμερικής. Συγκεκριμένα, περιλαμβάνει δεδομένα καταγραφής εγκλημάτων για το Los Angeles από το 2010 μέχρι σήμερα. 

Τα δεδομένα είναι διαθέσιμα σε csv file format στους παρακάτω συνδέσμους:
- [Crime-Data-from-2010-to-2019](https://data.lacity.org/Public-Safety/Crime-Data-from-2010-to-2019/63jg-8b9z)
- [Crime-Data-from-2020-to-Present](https://data.lacity.org/Public-Safety/Crime-Data-from-2020-to-Present/2nrs-mtv8)

Στους ίδιους συνδέσμους παρέχονται περιγραφές για κάθε ένα από τα 28 πεδία των δεδομένων.

#### Δευτερεύοντα data-sets

Συμπληρωματικά με τα παραπάνω δεδομένα, θα χρησιμοποιηθεί μια σειρά δεδομένων μικρότερου όγκου τα οποία επίσης είναι διαθέσιμα σε δημόσια αποθετήρια ή πηγές:

**2010 Census Blocks (Los Angeles County):** Ένα σύνολο δεδομένων που παρουσιάζει απογραφικά στοιχεία που αφορούν στην Κομητεία του Los Angeles για το έτος 2010 σε geojson format. Συνοδεύεται από αρχείο με περιγραφές των πεδίων του (2010_Census_Blocks_fields.csv). Είναι διαθέσιμο στον παρακάτω [σύνδεσμο](https://data.lacounty.gov/maps/lacounty::2010-census-blocks).

**Median Household Income by Zip Code (Los Angeles County):** Ένα ακόμα μικρό σύνολο δεδομένων που περιέχει δεδομένα σχετικά με το μέσο εισόδημα ανά νοικοκυριό και ταχυδρομικό κώδικα (ZIP Code)ψστην Κομητεία του Los Angeles. Για διευκόλυνση, τα δεδομένα έχουν συλλεχθεί και αποθηκευθεί σε csv file format. Τα συγκεκριμένο σύνολο δεδομένων παράχθηκε με βάση τα αποτελέσματα της απογραφής του έτους 2015 και είναι διαθέσιμα στον παρακάτω [σύνδεσμο](http://www.laalmanac.com/employment/em12c_2015.php).

**LA Police Stations:** Μικρό σύνολο δεδομένων που περιέχει δεδομένα σχετικά με την τοποθεσία των 21 αστυνομικών τμημάτων που βρίσκονται στην πόλη του Los Angeles. Τα συγκεκριμένα δεδομένα προέρχονται από δημόσιο αποθετήριο δεδομένων του δήμου του Los Angeles και είναι διαθέσιμα σε csv file format στον παρακάτω [σύνδεσμο](https://geohub.lacity.org/datasets/lahub::lapd-police-stations/explore).

**Race and Ethnicity codes:** Ένα μικρό σύνολο δεδομένων που περιέχει τις πλήρες περιγραφές που αντιστοιχούν στην κωδικοποίηση του φυλετικού προφίλ που χρησιμοποιείται στο βασικό σύνολο δεδομένων.

### Ερωτήματα

#### Query 1

Να ταξινομημηθούν, σε φθίνουσα σειρά, οι ηλικιακές ομάδες των θυμάτων σε περιστατικά που περιλαμβάνουν οποιαδήποτε μορφή *“βαριάς σωματικής βλάβης”*. 

Θεωρείστε τις εξής ηλικιακές ομάδες:
- **Παιδιά:** < 18
- **Νεαροί ενήλικοι:** 18 - 24
- **Ενήλικοι:** 25 - 64
- **Ηλικιωμένοι:** > 64

#### Query 2

Να βρεθούν, για κάθε έτος, τα 3 Αστυνομικά Τμήματα με το υψηλότερο ποσοστό κλεισμένων (περατωμένων) υποθέσεων. Να τυπωθούν το έτος, τα ονόματα (τοποθεσίες) των τμημάτων, τα ποσοστά τους καθώς και οι αριθμοί του ranking τους στην ετήσια κατάταξη. 
Τα αποτελέσματα να δοθούν σε σειρά αύξουσα ως προς το έτος και το ranking, όπως στο παρακάτω υπόδειγμα:

| year | precinct | closed_case_rate | # |
|---|---|---|---|
| 2010 | West Valley | 30.57974335472044 | 1 |
| 2010 | Mission | 29.23808669119627 | 2 |
| 2010 | N Hollywood | 27.58372669119627 | 3 |

#### Query 3

Χρησιμοποιώντας ως αναφορά τα δεδομένα της απογραφής 2010 για τον πληθυσμό και εκείνα της απογραφής του 2015 για το εισόδημα ανα νοικοκυριό, να υπολογίσετε για κάθε περιοχή του Los Angeles τα παρακάτω: 
- Το μέσο ετήσιο εισόδημα ανά άτομο 
- Την αναλογία συνολικού αριθμού εγκλημάτων ανά άτομο

Τα αποτελέσματα να συγκεντρωθούν σε ένα πίνακα.

#### Query 4

Να βρεθεί το φυλετικό προφίλ των καταγεγραμμένων θυμάτων εγκλημάτων (Vict Descent) στο Los Angeles για το έτος 2015 στις 3 περιοχές με το υψηλότερο κατά κεφαλήν εισόδημα. Να γίνει το ίδιο για τις 3 περιοχές με το χαμηλότερο εισόδημα. 

Να χρησιμοποιήσετε την αντιστοίχιση των κωδικών καταγωγής με την πλήρη περιγραφή από το σύνολο δεδομενων Race and Ethnicity codes. Τα αποτελέσματα να τυπωθούν σε δύο ξεχωριστούς πίνακες από το υψηλότερο στο χαμηλότερο αριθμό θυμάτων ανά φυλετικό γκρουπ, όπως στο παρακάτω υπόδειγμα:

| Victim Descent | # |
|---|---|
| White | 413 |
| Black | 274 |
| Unknown | 132 |
| Hispanic/Latin/Mexican | 12 |

#### Query 5

Nα υπολογιστεί, ανά αστυνομικό τμήμα, ο αριθμός εγκλημάτων που έλαβαν χώρα πλησιέστερα σε αυτό, καθώς και η μέση απόστασή του από τις τοποθεσίες όπου σημειώθηκαν τα συγκεκριμένα περιστατικά. 

Τα αποτελέσματα να εμφανιστούν ταξινομημένα κατά αριθμό περιστατικών, με φθίνουσα σειρά, όπως στο παρακάτω υπόδειγμα:

| division | average_distance | # |
|---|---|---|
| 77TH STREET | 2.208 | 7045 |
| RAMPART | 2.009 | 4595 |
| FOOTHILL | 3.597 | 3047 |
| PACIFIC | 2.739 | 2132 |
